<div class="pending-bookings-container">
    <!-- Header Section with Action-Oriented Design -->
    <div class="header">
        <div class="header-top">
            <div class="header-content">
                <h1>Pending Booking Requests</h1>
                <p class="header-subtitle">Review and respond to reservation requests requiring your attention</p>
            </div>
            <div class="quick-actions">
                <button class="quick-action-btn refresh" (click)="loadPendingBookings()">
                    Refresh
                </button>
            </div>
        </div>

        <!-- Urgency Statistics -->
        <div class="urgency-stats">
            <div class="urgency-card urgent">
                <div class="urgency-icon">üö®</div>
                <div class="urgency-info">
                    <span class="urgency-number">{{ getUrgencyStats().urgent }}</span>
                    <span class="urgency-label">Urgent (‚â§1 day)</span>
                </div>
            </div>
            <div class="urgency-card moderate">
                <div class="urgency-icon">‚ö†Ô∏è</div>
                <div class="urgency-info">
                    <span class="urgency-number">{{ getUrgencyStats().moderate }}</span>
                    <span class="urgency-label">Moderate (2-3 days)</span>
                </div>
            </div>
            <div class="urgency-card normal">
                <div class="urgency-icon">üìã</div>
                <div class="urgency-info">
                    <span class="urgency-number">{{ getUrgencyStats().normal }}</span>
                    <span class="urgency-label">Normal (>3 days)</span>
                </div>
            </div>
            <div class="urgency-card total">
                <div class="urgency-icon">üìä</div>
                <div class="urgency-info">
                    <span class="urgency-number">{{ getUrgencyStats().total }}</span>
                    <span class="urgency-label">Total Pending</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Error Message -->
    <div *ngIf="error" class="error-message">
        <i class="error-icon">‚ö†Ô∏è</i>
        {{ error }}
        <button (click)="loadPendingBookings()" class="retry-btn">Retry</button>
    </div>

    <!-- Action Bar with Filters -->
    <div class="action-bar">
        <div class="search-section">
            <div class="search-box">
                <i class="search-icon">üîç</i>
                <input type="text" [(ngModel)]="searchQuery" (ngModelChange)="onSearchChange()"
                    placeholder="Search pending requests..." class="search-input">
            </div>
        </div>

        <div class="filter-section">
            <div class="filter-group">
                <label>Urgency:</label>
                <select [(ngModel)]="urgencyFilter" (ngModelChange)="onFilterChange()" class="filter-select urgency">
                    <option value="all">All Requests</option>
                    <option value="urgent">Urgent Only</option>
                    <option value="today">Check-in Today</option>
                    <option value="week">Within Week</option>
                </select>
            </div>

            <div class="filter-group">
                <label>Price Range:</label>
                <select [(ngModel)]="priceRangeFilter" (ngModelChange)="onFilterChange()" class="filter-select price">
                    <option value="all">All Prices</option>
                    <option value="low">$0 - $200</option>
                    <option value="medium">$200 - $500</option>
                    <option value="high">$500+</option>
                </select>
            </div>

            <button (click)="clearFilters()" class="clear-filters-btn">
                Clear All
            </button>
        </div>
    </div>

    <!-- Loading Spinner -->
    <div *ngIf="loading" class="loading-spinner">
        <div class="spinner urgent"></div>
        <p>Loading pending requests...</p>
    </div>
    <!-- Pending Bookings List -->
    <div *ngIf="!loading" class="pending-list">
        @for(booking of paginatedBookings; track booking.id){
        <div class="pending-card" [ngClass]="getUrgencyLevel(booking)">

            <!-- Urgency Banner -->
            <div class="urgency-banner" [ngClass]="getUrgencyLevel(booking)">
                <span class="urgency-indicator">
                    <span *ngIf="getUrgencyLevel(booking) === 'urgent'" class="banner-text">üö® URGENT REQUEST</span>
                    <span *ngIf="getUrgencyLevel(booking) === 'moderate'" class="banner-text">‚ö†Ô∏è MODERATE
                        PRIORITY</span>
                    <span *ngIf="getUrgencyLevel(booking) === 'normal'" class="banner-text">üìã STANDARD REQUEST</span>
                </span>
                <span class="days-until">
                    {{ getDaysUntilCheckIn(booking) }} days until check-in
                </span>
            </div>

            <!-- Card Header -->
            <div class="card-header">
                <div class="booking-info">
                    <div class="booking-id">Request #{{ booking.id }}</div>
                    <div class="request-time">
                        <small>Received: {{ formatDate(booking.startDate) }}</small>
                    </div>
                </div>
                <div class="price-highlight">
                    <span class="price-amount">{{ formatPrice(booking.totalPrice) }}</span>
                    <span class="price-label">Total Value</span>
                </div>
            </div>

            <!-- Guest and Room Details -->
            <div class="card-content">
                <div class="guest-section">
                    <div class="guest-avatar">
                        <span class="avatar-initial">{{ booking.customerEmail.charAt(0).toUpperCase() }}</span>
                    </div>
                    <div class="guest-details">
                        <h3 class="guest-email">{{ booking.customerEmail }}</h3>
                        <div class="contact-info">
                            <button class="contact-btn">üìß Email Guest</button>
                        </div>
                    </div>
                </div>

                <div class="booking-details">
                    <div class="detail-row">
                        <span class="detail-label">Room Type:</span>
                        <span class="detail-value room-type">{{ booking.roomType }}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Hotel:</span>
                        <span class="detail-value">{{ booking.hotelName }}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Duration:</span>
                        <span class="detail-value">{{ calculateNights(booking.checkInDate, booking.checkOutDate) }}
                            nights</span>
                    </div>
                    <div class="detail-row dates">
                        <div class="date-info">
                            <span class="date-label">Check-in:</span>
                            <span class="date-value">{{ formatDate(booking.checkInDate) }}</span>
                        </div>
                        <div class="date-separator">‚Üí</div>
                        <div class="date-info">
                            <span class="date-label">Check-out:</span>
                            <span class="date-value">{{ formatDate(booking.checkOutDate) }}</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="action-section">
                <button (click)="cancelBooking(booking.id)" [disabled]="processingBookingId === booking.id"
                    class="action-btn decline">
                    <span *ngIf="processingBookingId !== booking.id">‚ùå Decline</span>
                    <span *ngIf="processingBookingId === booking.id">Processing...</span>
                </button>
            </div>
        </div>
        }


        <!-- Empty State -->
        <div *ngIf="filteredBookings.length === 0" class="empty-state">
            <div class="empty-icon">üéâ</div>
            <h3>No Pending Requests!</h3>
            <p>All booking requests have been processed. Check back later for new requests.</p>
            <button (click)="clearFilters()" class="clear-filters-btn">View All Requests</button>
        </div>
    </div>

    <!-- Pagination -->
    <div *ngIf="!loading && filteredBookings.length > 0" class="pagination">
        <div class="pagination-info">
            Showing {{ (currentPage - 1) * itemsPerPage + 1 }} -
            {{getMin(currentPage * itemsPerPage, filteredBookings.length) }}
            of {{ filteredBookings.length }} pending requests
        </div>

        <div class="pagination-controls">
            <button (click)="changePage(currentPage - 1)" [disabled]="currentPage === 1" class="pagination-btn">
                ‚Üê Previous
            </button>

            <button *ngFor="let page of pageNumbers" (click)="changePage(page)"
                [ngClass]="{'active': page === currentPage}" class="pagination-btn page-number">
                {{ page }}
            </button>

            <button (click)="changePage(currentPage + 1)" [disabled]="currentPage === totalPages"
                class="pagination-btn">
                Next ‚Üí
            </button>
        </div>
    </div>
</div>