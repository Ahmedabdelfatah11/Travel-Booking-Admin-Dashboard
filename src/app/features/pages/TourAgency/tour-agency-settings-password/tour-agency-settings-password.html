<!-- Full-Screen Loader -->
@if(isLoading) {
  <div class="loader-container">
    <div class="loader">
      <div class="loader__ball"></div>
      <div class="loader__ball"></div>
      <div class="loader__ball"></div>
    </div>
  </div>
}

<div class="settings-container">
  <h2><i class="fas fa-lock"></i> Change Password</h2>

  @if (error) {
    <div class="alert alert-danger"><i class="fas fa-exclamation-triangle"></i> {{ error }}</div>
  }

  @if (success) {
    <div class="alert alert-success"><i class="fas fa-check-circle"></i> {{ success }}</div>
  }

  <form [formGroup]="passwordForm" (ngSubmit)="onChangePassword()" class="password-form">

    <div class="form-group">
      <label for="currentPassword">Current Password</label>
      <input 
        id="currentPassword" 
        type="password" 
        formControlName="currentPassword"
        class="form-control"
        [class.is-invalid]="currentPassword.invalid && currentPassword.touched">
      @if (currentPassword.invalid && currentPassword.touched) {
        <div class="invalid-feedback">Current password is required.</div>
      }
    </div>

    <div class="form-group">
      <label for="newPassword">New Password</label>
      <input 
        id="newPassword" 
        type="password" 
        formControlName="newPassword"
        class="form-control"
        [class.is-invalid]="newPassword.invalid && newPassword.touched">
      @if (newPassword.invalid && newPassword.touched) {
        <div class="invalid-feedback">Must be at least 6 characters.</div>
      }
    </div>

    <div class="form-group">
      <label for="confirmNewPassword">Confirm New Password</label>
      <input 
        id="confirmNewPassword" 
        type="password" 
        formControlName="confirmNewPassword"
        class="form-control"
        [class.is-invalid]="confirmNewPassword.invalid && confirmNewPassword.touched">
      @if (confirmNewPassword.invalid && confirmNewPassword.touched) {
        <div class="invalid-feedback">Must match new password.</div>
      }
    </div>

    <button 
      type="submit"
      [disabled]="isSubmitting"
      class="btn btn-success mt-3">
      <i class="fas fa-key"></i> {{ isSubmitting ? 'Changing...' : 'Change Password' }}
    </button>
  </form>
</div>